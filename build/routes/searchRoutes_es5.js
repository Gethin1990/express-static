var express=require("express"),searchRouter=express.Router(),elasticsearch=require("elasticsearch"),connectionString="localhost:9200",client=new elasticsearch.Client({host:connectionString,log:"trace"}),_index="wiki",_type="article";searchRouter.route("/").get(function(e,r){r.render("Search",{title:"INSTAR Wiki Search"})}),searchRouter.route("/Results").get(function(e,r){var t=e.query.agg_value,s=e.query.agg_field,i={};i[s]=t,client.search({index:_index,type:_type,body:{query:{filtered:{query:{multi_match:{query:e.query.q,fields:["title^100","tags^50","abstract^20","description^10","models^5","chapter^5","title2^5"],fuzziness:1}}}}}}).then(function(t){r.render("Search_Results",{title:"INSTAR Wiki Search Results",response:t,query:e.query.q})},function(e){console.trace(e.message),r.render("Search_Results",{title:"INSTAR Wiki Search Results",response:e.message})})}),module.exports=searchRouter;